<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Campaign Stats</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      text-align: center;
    }
    .stats {
      display: flex;
      justify-content: center;
      gap: 50px;
      margin-top: 20px;
    }
    .stat-box {
      text-align: center;
    }
    .stat-box h2 {
      font-size: 20px;
      margin-bottom: 10px;
    }
    .stat-box p {
      font-size: 24px;
      margin: 0;
      font-weight: bold;
    }
    input {
      margin: 10px;
      padding: 8px;
      width: 250px;
    }
    button {
      padding: 10px 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Campaign Analytics</h1>
  <div>
    <input id="api-key" type="text" placeholder="Enter API Key">
    <input id="campaign-id" type="text" placeholder="Enter Campaign ID">
    <button onclick="fetchCampaignStats()">Fetch Stats</button>
  </div>

  <div class="stats">
    <div class="stat-box">
      <h2>Unique Prospects</h2>
      <p id="emails-sent">-</p>
    </div>
    <div class="stat-box">
      <h2>Total Replies</h2>
      <p id="reply-rate">-</p>
    </div>
    <div class="stat-box">
      <h2>Positive Replies</h2>
      <p id="positive-reply-rate">-</p>
    </div>
  </div>

  <script>
    async function fetchCampaignStats() {
      const apiKey = document.getElementById('api-key').value.trim();
      const campaignId = document.getElementById('campaign-id').value.trim();

      if (!apiKey || !campaignId) {
        alert('Please enter both API Key and Campaign ID!');
        return;
      }

      const campaignUrl = `https://server.smartlead.ai/api/v1/campaigns/${campaignId}/analytics?api_key=${apiKey}`;

      try {
        const campaignResponse = await fetch(campaignUrl);
        if (!campaignResponse.ok) {
          const errorText = await campaignResponse.text();
          console.error(`Error fetching campaign stats: ${campaignResponse.status} - ${errorText}`);
          alert(`Error fetching campaign stats: ${campaignResponse.status} - ${errorText}`);
          return;
        }
        const campaignData = await campaignResponse.json();

        const uniqueProspects = campaignData.unique_sent_count || 0;
        const totalReplies = campaignData.reply_count || 0;
        const interestedCount = campaignData.campaign_lead_stats?.interested || 0;

        document.getElementById('emails-sent').textContent = `${uniqueProspects} prospects`;
        document.getElementById('reply-rate').textContent = `${totalReplies} replies`;
        document.getElementById('positive-reply-rate').textContent = `${interestedCount} positive`;

      } catch (error) {
        console.error('Detailed error:', error);
        alert('An error occurred while fetching data. Check console for details.');
      }
    }
  </script>
</body>
</html>

